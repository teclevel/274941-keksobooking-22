{"version":3,"sources":["webpack://keksobooking/./source/js/datum-initial.js","webpack://keksobooking/./source/js/activation-site.js","webpack://keksobooking/./source/js/similar-element.js","webpack://keksobooking/./source/js/util.js","webpack://keksobooking/./source/js/filtration.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/create-fetch.js","webpack://keksobooking/./source/js/avatar.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/user-form.js"],"names":["housing","palace","flat","house","bungalow","price","addressLocation","lat","lng","formAdvertisement","document","querySelector","fieldsetUserData","fieldsAd","querySelectorAll","formFilter","filters","filterFeatures","toggleFormAd","state","classList","toggle","toggleAttribute","forEach","element","toggleFilters","balloonTemplate","content","isEscEvent","evt","key","showMessageError","textAlert","message","createElement","textContent","style","position","zIndex","top","left","right","fontSize","color","textAlign","padding","backgroundColor","body","append","setTimeout","remove","DefaultValue","formFiltration","filterHousing","filterPrice","filterRooms","filterGuests","listFilterFeatures","filterAdvertisements","data","offer","value","type","isTypeOfHouse","parseInt","rooms","isRoomsInAd","guests","isGuestsInAd","isPriceOfHouse","checkboxesChecked","checked","push","getCheckedFeatures","every","feature","features","includes","isFeatureInAd","markersSimilarAd","addMarkers","arrayAdvertisements","filter","slice","point","location","icon","L","iconUrl","iconSize","iconAnchor","markerSimilarAd","marker","addTo","map","bindPopup","advertisement","author","newAdvertisement","cloneNode","src","avatar","title","address","numberRooms","prefixRooms","numberGuests","prefixGuests","checkin","checkout","description","popupPhotos","popupPhoto","removeChild","photos","item","appendChild","featuresList","featuresItems","featureItem","className","createCustomPopup","keepInView","on","onSuccess","ad","cb","_","debounce","addEventListener","removeLayer","fetch","then","response","json","catch","setView","tileLayer","attribution","mainAddress","setAttribute","setMainMarker","mainPinIcon","draggable","_latlng","target","getLatLng","toFixed","deleteMarker","FILE_TYPES","avatarChooser","previewAvatar","previewFile","fileChooser","blockFile","setImage","el","preview","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","result","readAsDataURL","removeAvatar","removeImage","innerHTML","objectFit","buttonSubmit","buttonReset","adForm","popupSuccess","add","popupError","buttonError","closePopupSuccess","reset","resetFieldGuest","setInitialPrice","removeEventListener","onPopupSuccessClick","onPopupSuccessEsc","closePopupError","onPopupErrorEsc","preventDefault","typeHousing","priceHousing","timeIn","timeOut","fieldSelectRooms","children","fieldSelectGuests","placeholder","min","selectTime","time1","time2","selectedIndex","selected","removeAttribute","onFail","method","ok","sendData","FormData"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const housing = {\n  palace: 'Дворец',\n  flat: 'Квартира',\n  house: 'Дом',\n  bungalow: 'Бунгало',\n};\n\nconst price = {\n  palace: '10000',\n  flat: '1000',\n  house: '5000',\n  bungalow: '0',\n};\n\nconst addressLocation = {\n  lat: '35.68170',\n  lng: '139.75388',\n}\n\nexport {housing, price, addressLocation};\n","const formAdvertisement = document.querySelector('.ad-form');\nconst fieldsetUserData = formAdvertisement.querySelector('.ad-form-header');\nconst fieldsAd = formAdvertisement.querySelectorAll('.ad-form__element');\n\nconst formFilter = document.querySelector('.map__filters');\nconst filters = formFilter.querySelectorAll('.map__filter');\nconst filterFeatures = formFilter.querySelector('.map__features');\n\nconst toggleFormAd = (state) => {\n  formAdvertisement.classList.toggle('ad-form--disabled', state);\n  fieldsetUserData.toggleAttribute('disabled', state);\n\n  fieldsAd.forEach((element) => {\n    element.toggleAttribute('disabled', state);\n  });\n\n};\n\nconst toggleFilters = (state) => {\n  formFilter.classList.toggle('map__filters--disabled', state);\n  filterFeatures.toggleAttribute('disabled', state);\n\n  filters.forEach((element) => {\n    element.toggleAttribute('disabled', state);\n  });\n};\n\nexport {toggleFilters, toggleFormAd};\n","import {housing} from './datum-initial.js'\n\nconst balloonTemplate = document.querySelector('#card').content.querySelector('.popup');\n\n\nconst createCustomPopup = (advertisement) => {\n  const {author, offer} = advertisement;\n  const newAdvertisement = balloonTemplate.cloneNode(true);\n  newAdvertisement.querySelector('.popup__avatar').src = author.avatar;\n  newAdvertisement.querySelector('.popup__title').textContent = offer.title;\n  newAdvertisement.querySelector('.popup__text--address').textContent = offer.address;\n  newAdvertisement.querySelector('.popup__text--price').textContent = offer.price + ' ₽/ночь';\n\n  const numberRooms = offer.rooms;\n  let prefixRooms =' комнат для ';\n  const numberGuests = offer.guests;\n  let prefixGuests = ' гостей';\n\n  switch (numberRooms % 10) {\n    case 1:\n      prefixRooms = ' комната для ';\n      break;\n    case 2:\n    case 3:\n    case 4:\n      prefixRooms = ' комнаты для ';\n      break;\n\n    default: prefixRooms =' комнат для ';\n      break;\n  }\n\n  switch (numberGuests % 10) {\n    case 1:\n      prefixGuests = ' гостя';\n      break;\n    default:\n      prefixGuests = ' гостей';\n      break;\n  }\n\n  newAdvertisement.querySelector('.popup__text--capacity').textContent = numberRooms + prefixRooms + numberGuests + prefixGuests;\n  newAdvertisement.querySelector('.popup__text--time').textContent = 'Заезд после ' + offer.checkin + ', выезд до ' + offer.checkout;\n  newAdvertisement.querySelector('.popup__description').textContent = offer.description;\n\n\n  const popupPhotos = newAdvertisement.querySelector('.popup__photos');\n  const popupPhoto = newAdvertisement.querySelector('.popup__photo');\n  popupPhotos.removeChild(popupPhoto);\n\n  offer.photos.forEach((item) => {\n    popupPhoto.src = item;\n    popupPhotos.appendChild(popupPhoto.cloneNode(true));\n  });\n\n\n  const featuresList = newAdvertisement.querySelector('.popup__features');\n  const featuresItems = newAdvertisement.querySelectorAll('.popup__feature');\n  const featureItem = newAdvertisement.querySelector('.popup__feature')\n\n  featuresItems.forEach((item) => {\n    featuresList.removeChild(item);\n  });\n\n  offer.features.forEach((item) => {\n    featureItem.className = ('popup__feature popup__feature--'+ item);\n    featuresList.appendChild(featureItem.cloneNode(true));\n  });\n\n\n  const typeOfHousing = newAdvertisement.querySelector('.popup__type');\n  typeOfHousing.textContent = housing[offer.type];\n\n  return newAdvertisement;\n};\n\nexport {createCustomPopup};\n","const isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\n\nconst showMessageError = (textAlert) => {\n  const message = document.createElement('div');\n  message.textContent = textAlert;\n  message.style.position = 'fixed';\n  message.style.zIndex = '1000';\n  message.style.top = '20px';\n  message.style.left = '0';\n  message.style.right = '0';\n  message.style.fontSize = '32px'\n  message.style.color = 'yellow';\n  message.style.textAlign = 'center';\n  message.style.padding = '10px 10px';\n  message.style.backgroundColor = 'red';\n  document.body.append(message);\n\n  setTimeout(() => {\n    message.remove();\n  }, 3000);\n};\n\n\nexport {isEscEvent, showMessageError};\n","import {markersSimilarAd, removeSimilarAdMarkers} from './map.js';\n\nconst DefaultValue = {\n  ANY_VALUE: 'any',\n  MIDDLE_MIN: 10000,\n  MIDDLE_MAX: 50000,\n  LOW: 10000,\n  HIGH: 50000,\n};\n\nconst formFiltration =  document.querySelector('.map__filters');\nconst filterHousing = formFiltration.querySelector('#housing-type');\nconst filterPrice = formFiltration.querySelector('#housing-price');\nconst filterRooms = formFiltration.querySelector('#housing-rooms');\nconst filterGuests = formFiltration.querySelector('#housing-guests');\nconst listFilterFeatures = formFiltration.querySelectorAll('.map__checkbox');\n\n\nconst setFilterFormChange = (cb) => {\n  formFiltration.addEventListener('change', () => {\n    removeSimilarAdMarkers(markersSimilarAd);\n    cb();\n  });\n};\n\nconst isTypeOfHouse = (element) => {\n  const {offer} = element;\n  return  filterHousing.value === offer.type ||\n  filterHousing.value === DefaultValue.ANY_VALUE;\n};\n\nconst isRoomsInAd = (element) => {\n  const {offer} = element;\n  return parseInt(filterRooms.value) === offer.rooms ||\n  filterRooms.value === DefaultValue.ANY_VALUE;\n};\n\nconst isGuestsInAd = (element) => {\n  const {offer} = element;\n  return parseInt(filterGuests.value) === offer.guests ||\n  filterGuests.value === DefaultValue.ANY_VALUE;\n};\n\nconst isPriceOfHouse = (element) => {\n  const {offer} = element\n  return filterPrice.value === filterPrice[0].value ||\n  filterPrice.value === filterPrice[1].value && offer.price > DefaultValue.MIDDLE_MIN && offer.price <= DefaultValue.MIDDLE_MAX ||\n  filterPrice.value === filterPrice[2].value && offer.price <= DefaultValue.LOW ||\n  filterPrice.value === filterPrice[3].value && offer.price >= DefaultValue.HIGH;\n};\n\nconst getCheckedFeatures = () => {\n  const checkboxesChecked = [];\n  for (let element of  listFilterFeatures){\n    if (element.checked){\n      checkboxesChecked.push(element.value);\n    }\n  }\n  return checkboxesChecked;\n};\n\nconst  isFeatureInAd = (element) => {\n  const {offer} = element;\n  const checkedItems = getCheckedFeatures();\n  return checkedItems.every((feature) => offer.features.includes(feature));\n};\n\nconst filterAdvertisements = (data) => {\n  return isTypeOfHouse(data) &&\n  isRoomsInAd(data) &&\n  isGuestsInAd(data) &&\n  isPriceOfHouse(data)&&\n  isFeatureInAd(data);\n};\n\nexport {setFilterFormChange, filterAdvertisements};\n","/* global L:readonly */\n/* global _:readonly */\nimport {toggleFilters, toggleFormAd} from './activation-site.js';\nimport {createCustomPopup} from './similar-element.js';\nimport {addressLocation} from './datum-initial.js';\nimport {getData} from './create-fetch.js'\nimport {setFilterFormChange, filterAdvertisements} from './filtration.js';\n\nconst RERENDER_DELAY = 500;\nconst NUMBER_ADVERTISEMENTS = 10;\n\n\nconst markersSimilarAd = [];\nconst addMarkers = (arrayAdvertisements) => {\n  arrayAdvertisements\n    .filter(filterAdvertisements)\n    .slice(0, NUMBER_ADVERTISEMENTS)\n    .forEach((point) => {\n      const {lat, lng} = point.location;\n\n      const icon = L.icon({\n        iconUrl: './img/pin.svg',\n        iconSize: [40, 40],\n        iconAnchor: [20, 40],\n      });\n\n      const markerSimilarAd = L.marker(\n        {\n          lat,\n          lng,\n        },\n        {\n          icon,\n        },\n      );\n      markerSimilarAd\n        .addTo(map)\n        .bindPopup(\n          createCustomPopup(point),\n          {\n            keepInView: true,\n          },\n        );\n      markersSimilarAd.push(markerSimilarAd);\n    });\n};\n\nconst removeSimilarAdMarkers = (markers) => {\n  markers.forEach((marker) => map.removeLayer(marker));\n  markers = [];\n};\n\ntoggleFormAd(true);\ntoggleFilters(true);\n\nconst map = L.map('map-canvas')\n  .on('load', () => {                          //подписка на события. здесь инициализация карты\n    toggleFormAd(false);\n    toggleFilters(false);\n    getData((ad) => {\n      addMarkers(ad);\n      setFilterFormChange( _.debounce(\n        () => addMarkers(ad),\n        RERENDER_DELAY));\n    });\n  })\n  .setView(\n    addressLocation, 10);\n\nL.tileLayer(                                   //добавляет карту от OpenStreetMap\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\nconst mainAddress = document.querySelector('#address');\nmainAddress.setAttribute('readonly', '');\n\nlet marker;\nconst setMainMarker = (location) => {\n\n  const mainPinIcon = L.icon({                  //созд главного маркер\n    iconUrl: './img/main-pin.svg',\n    iconSize: [50, 82],\n    iconAnchor: [25, 82],\n  });\n\n  marker = L.marker(\n    location,\n    {\n      draggable: true,                           //разрешение на передвижение маркера\n      icon: mainPinIcon,\n    },\n  );\n  marker.addTo(map);\n\n  mainAddress.value = `${marker._latlng.lat}, ${marker._latlng.lng}`\n\n  marker.on('moveend', (evt) => {\n    const position = evt.target.getLatLng();     //передает координаты маркера\n    mainAddress.value = `${position.lat.toFixed(5)}, ${position.lng.toFixed(5)}`;\n  });\n};\n\nsetMainMarker(addressLocation);\n\nconst deleteMarker = () => {\n  marker.remove();\n};\n\nexport {deleteMarker, setMainMarker, markersSimilarAd, removeSimilarAdMarkers};\n","import {toggleFilters} from './activation-site.js';\nimport {showMessageError} from './util.js';\n\nconst getData = (onSuccess) => {\n  fetch('https://22.javascript.pages.academy/keksobooking/data')\n    .then((response) => response.json())\n    .then(onSuccess)\n\n    .catch(() => {\n      showMessageError('Ошибка получения данных');\n      toggleFilters(true);\n    });\n};\n\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch(\n    'https://22.javascript.pages.academy/keksobooking',\n    {\n      method: 'POST',\n      body,\n    },\n  ).then((response) => {\n    if (response.ok) {\n      onSuccess();\n    } else {\n      onFail();\n    }\n  })\n    .catch(() => {\n      showMessageError('Ошибка отправления данных')\n    });\n};\n\nexport {getData, sendData};\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\n\nconst avatarChooser = document.querySelector('#avatar');\nconst previewAvatar = document.querySelector('.ad-form-header__preview > img');\nconst previewFile = document.createElement('img');\nconst fileChooser = document.querySelector('#images');\nconst blockFile = document.querySelector('.ad-form__photo');\n\n\nconst getPreviewImage = () => {\n  blockFile.appendChild(previewFile);\n  previewFile.setAttribute('src', '');\n  previewFile.setAttribute('width', '100%');\n  previewFile.setAttribute('height', '100%');\n  previewFile.style.objectFit = 'cover';\n  return previewFile;\n};\n\nconst setImage = (el, preview) => {\n  const file = el.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      preview.src = reader.result;\n    });\n\n    reader.readAsDataURL(file);\n  }\n};\n\n\nconst removeAvatar = () => {\n  previewAvatar.src = 'img/muffin-grey.svg';\n}\n\nconst removeImage = () => {\n  blockFile.innerHTML = '';\n}\n\navatarChooser.addEventListener('change', () => {\n  setImage(avatarChooser, previewAvatar);\n});\n\nfileChooser.addEventListener('change', () => {\n  setImage(fileChooser, getPreviewImage());\n});\n\nexport {removeImage, removeAvatar}\n","import {addressLocation} from './datum-initial.js';\nimport {setMainMarker, deleteMarker} from './map.js';\nimport {resetFieldGuest, setInitialPrice} from './user-form.js';\nimport {isEscEvent} from './util.js';\nimport {removeImage, removeAvatar} from './avatar.js';\n\nconst buttonSubmit = document.querySelector('.ad-form__submit')\nconst buttonReset = document.querySelector('.ad-form__reset');\nconst adForm = document.querySelector('.ad-form');\n\nconst templateSuccess = document.querySelector('#success')\n  .content.querySelector('.success');\nconst popupSuccess = templateSuccess.cloneNode(true);\npopupSuccess.classList.add('hidden')\ndocument.body.append(popupSuccess);\n\nconst templateError = document.querySelector('#error')\n  .content.querySelector('.error');\nconst popupError = templateError.cloneNode(true);\npopupError.classList.add('hidden');\ndocument.body.append(popupError);\nconst buttonError = document.querySelector('.error__button');\n\n\nconst openPopupSuccess = () => {\n  popupSuccess.classList.remove('hidden');\n  buttonSubmit.toggleAttribute('disabled', true);\n  document.addEventListener('click', onPopupSuccessClick);\n  document.addEventListener('keydown', onPopupSuccessEsc);\n};\n\nconst closePopupSuccess = () => {\n  popupSuccess.classList.add('hidden');\n  buttonSubmit.toggleAttribute('disabled', false);\n  adForm.reset();\n  resetFieldGuest();\n  deleteMarker();\n  setMainMarker(addressLocation);\n  setInitialPrice();\n  document.removeEventListener('click', onPopupSuccessClick);\n  document.removeEventListener('keydown', onPopupSuccessEsc);\n  removeImage();\n  removeAvatar();\n};\n\nconst onPopupSuccessClick = () => {\n  closePopupSuccess();\n};\n\nconst onPopupSuccessEsc = (evt) => {\n  if (isEscEvent(evt)){\n    closePopupSuccess();\n  }\n};\n\nconst openPopupError = () => {\n  popupError.classList.remove('hidden');\n  buttonSubmit.toggleAttribute('disabled', true);\n  document.addEventListener('keydown', onPopupErrorEsc);\n};\n\nconst closePopupError = () => {\n  popupError.classList.add('hidden');\n  buttonSubmit.toggleAttribute('disabled', false);\n  document.removeEventListener('keydown', onPopupErrorEsc);\n};\n\nconst onPopupErrorEsc = (evt) => {\n  if (isEscEvent(evt)){\n    closePopupError();\n  }\n};\n\nbuttonError.addEventListener('click', () => {\n  closePopupError();\n});\n\nbuttonReset.addEventListener('click', (evt) => {\n  evt.preventDefault();\n  adForm.reset();\n  resetFieldGuest();\n  deleteMarker();\n  setMainMarker(addressLocation);\n  setInitialPrice();\n  removeImage();\n  removeAvatar();\n});\n\nexport {openPopupSuccess};\nexport {openPopupError};\n","import {price} from './datum-initial.js';\nimport {openPopupError} from './popup.js';\nimport {sendData} from './create-fetch.js';\n\nconst DEFAULT_NUMBER = 1;\nconst typeHousing = document.querySelector('#type');\nconst priceHousing = document.querySelector('#price');\nconst timeIn = document.querySelector('#timein');\nconst timeOut = document.querySelector('#timeout');\nconst adForm = document.querySelector('.ad-form');\nconst fieldSelectRooms = adForm.querySelector('#room_number');\nconst numberRooms = fieldSelectRooms.children;\nconst fieldSelectGuests = adForm.querySelector('#capacity');\nconst numberGuests = fieldSelectGuests.children;\n\nconst setInitialPrice = () => {\n  priceHousing.placeholder = price[typeHousing.value];\n  priceHousing.min = priceHousing.placeholder;\n}\nsetInitialPrice();\n\ntypeHousing.addEventListener('change', () => {\n  setInitialPrice();\n});\n\nconst selectTime = (time1, time2) => {\n  time1.addEventListener('change', () => {\n    time2[time1.selectedIndex].selected = true;\n  });\n};\n\nselectTime(timeIn, timeOut);\nselectTime(timeOut, timeIn);\n\nconst resetFieldGuest = () => {\n  for (const element of numberGuests) {\n    if (!(parseInt(element.value) === DEFAULT_NUMBER)){\n      element.setAttribute('disabled','');\n    }\n  }\n}\n\nresetFieldGuest();\n\nfieldSelectRooms.addEventListener('change', () => {\n  resetFieldGuest();\n  numberGuests[2].setAttribute('disabled', '');\n\n  switch(fieldSelectRooms.value){\n\n    case numberRooms[2].value:\n      numberGuests[0].removeAttribute('disabled');\n    // eslint-disable-next-line no-fallthrough\n    case numberRooms[1].value:\n      numberGuests[1].removeAttribute('disabled');\n      // eslint-disable-next-line no-fallthrough\n    case numberRooms[0].value:\n      numberGuests[2].removeAttribute('disabled');\n      fieldSelectGuests.value = numberGuests[2].value;\n      break;\n\n    case numberRooms[3].value:\n      numberGuests[3].removeAttribute('disabled');\n      fieldSelectGuests.value = numberGuests[3].value;\n      break;\n  }\n});\n\nconst setUserFormSubmit = (onSuccess) => {\n  adForm.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n\n    sendData(                                                       //  sendData(onSuccess, onFail, body)\n      () => onSuccess(),\n      () => openPopupError(),\n      new FormData(evt.target),\n    );\n  });\n};\n\nexport {setUserFormSubmit, setInitialPrice, resetFieldGuest};\n"],"sourceRoot":""}